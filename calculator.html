<html>

<head>
  <meta charset="UTF-8">
  <title>Calculator</title>
  <link rel="stylesheet" type="text/css" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">
  <style>
    .calculator-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 250px;
    }

    .calculator-output {
      background-color: #fff;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      font-size: 2rem;
      padding-right: 0.5rem;
      width: 209px;
      height: 50px;
      margin: 0.2rem;
    }

    .cal-first,
    .cal-second,
    .cal-third,
    .cal-fourth,
    .cal-fifth {
      display: flex;
    }

    .cal-box {
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: Arial, Helvetica, sans-serif;
      font-weight: 700;
      font-size: 1.5rem;
      color: #fff;
      width: 50px;
      height: 50px;
      background-color: #000;
      margin: 0.2rem;
    }

    .cal-fifth {
      display: flex;
      justify-content: start;
      padding-left: 1.5rem;
      width: 100%;
    }

    .cal-equals {
      width: 106px;
    }
  </style>
</head>

<body>
  <div class="contentContainer">
    <h1>CALCULATOR</h1>
    <div class="calculator-container">
      <div class="calculator-output"></div>
      <div class="cal-first">
        <div class="cal-box cal-clear">c</div>
        <div class="cal-box cal-decimal">.</div>
        <div class="cal-box cal-divide">/</div>
        <div class="cal-box cal-multiply">x</div>
      </div>
      <div class="cal-second">
        <div class="cal-box cal-num cal-seven">7</div>
        <div class="cal-box cal-num cal-eight">8</div>
        <div class="cal-box cal-num cal-nine">9</div>
        <div class="cal-box cal-subtract">-</div>
      </div>
      <div class="cal-third">
        <div class="cal-box cal-num cal-four">4</div>
        <div class="cal-box cal-num cal-five">5</div>
        <div class="cal-box cal-num cal-six">6</div>
        <div class="cal-box cal-add">+</div>
      </div>
      <div class="cal-fourth">
        <div class="cal-box cal-num cal-one">1</div>
        <div class="cal-box cal-num cal-two">2</div>
        <div class="cal-box cal-num cal-three">3</div>
        <div class="cal-box cal-num cal-zero">0</div>
      </div>
      <div class="cal-fifth">
        <div class="cal-box cal-equals">=</div>
      </div>
    </div>
  </div>
  <script src="scripts.js"></script>
  <script>
    /* Building a calculator. Get past your block. What do you need to do? Project Requirements: OOP approach. Use contructors, new objects and create a prototype chain. */
    /* 
      Break down how a calculator works. Define each piece of functionality.
      1. decimal operational
      2. disallow no two operators to be stored in a row
    */

    function Info(targets, userSelection) {
      this.targets = targets;
      this.userSelection = userSelection;
    }

    Info.prototype.assignPlacement = function(tempNumber, selectionHistory) {
      if (typeof selectionHistory[selectionHistory.length - 1] === 'number' && typeof tempNumber === 'number') {
        selectionHistory.pop();
      }
      selectionHistory.push(tempNumber);
    }

    Info.prototype.stringToInt = function(string) {
      if (!Number.isNaN(Number.parseInt(string))) {
        return Number.parseInt(string);
      } else {
        return string;
      }
    }

    Info.prototype.filterSelection = function(targets) {
      let numbers = new String;
      targets.forEach(function(element, index, array) {
        if (!Number.isNaN(Number.parseInt(element))) {
          numbers += element;
          if (Number.isNaN(Number.parseInt(numbers[0]))) {
            numbers = numbers.slice(1);
          }
        } else {
          numbers = new String;
          numbers = element;
          if (Number.isNaN(Number.parseInt(array[index - 1]))) {
            console.log(array);
            // attempting to solve disallowing two operators to be chosen in a row. 
          }
        }
      });
      return numbers;
    }

    Info.prototype.evalSelection = function(userSelection) {
      if (userSelection.length > 3) {
        let retain = userSelection.pop();
        if (userSelection[1] === 'x') {
          userSelection = Array.of(equation.multiply(userSelection[0], userSelection[2]));
        } else if (userSelection[1] === '/') {
          userSelection = Array.of(equation.divide(userSelection[0], userSelection[2]));
        } else if (userSelection[1] === '+') {
          userSelection = Array.of(equation.add(userSelection[0], userSelection[2]));
        } else if (userSelection[1] === '-') {
          userSelection = Array.of(equation.subtract(userSelection[0], userSelection[2]));
        }
        if (retain !== '=') {
          userSelection.push(retain);
        }
      }
      return userSelection;
    }

    Info.prototype.multiply = function(a, b) {
      return a * b;
    }

    Info.prototype.divide = function(a, b) {
      return a / b;
    }

    Info.prototype.add = function(a, b) {
      return a + b;
    }

    Info.prototype.subtract = function(a, b) {
      return a - b;
    }

    Info.prototype.showUser = function(userSelection) {
      if (userSelection.length <= 2) {
        document.querySelector('.calculator-output').innerText = userSelection[0];
      } else {
        document.querySelector('.calculator-output').innerText = userSelection[2];
      }
    }

    Info.prototype.clearSelection = function(userSelection) {
      userSelection.forEach(function(element, index, array) {
        if (element === 'c') {
          userSelection.length = 0;
        }
      })
      return userSelection;
    }

    let equation = new Info(new Array, new Array);

    document.querySelectorAll('.cal-box').forEach(function(element, index, array) {
      element.addEventListener('click', function(event) {
        let temp = new Object;
        equation.targets.push(event.target.innerHTML);
        temp.number = equation.filterSelection(equation.targets);
        temp.number = equation.stringToInt(temp.number);
        equation.assignPlacement(temp.number, equation.userSelection);
        equation.userSelection = equation.evalSelection(equation.userSelection);
        equation.userSelection = equation.clearSelection(equation.userSelection);
        if (equation.userSelection.length === 0) {
          document.querySelector('.calculator-output').innerText = '';
        } else {
          equation.showUser(equation.userSelection);
        }
      });
    });

    // Do not let two operators be clicked in a row. You still need to make decimal's and highlights for the clicked buttons.
  </script>
</body>

</html>